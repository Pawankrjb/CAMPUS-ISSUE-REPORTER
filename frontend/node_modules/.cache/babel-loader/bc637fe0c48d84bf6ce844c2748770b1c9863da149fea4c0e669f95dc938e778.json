{"ast":null,"code":"import React,{useState}from'react';import{Form,Button,Alert,Card,Container}from'react-bootstrap';import{Link}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const[collegeId,setCollegeId]=useState('');const[password,setPassword]=useState('');const[role,setRole]=useState('user');const[error,setError]=useState('');const[message,setMessage]=useState('');const[loading,setLoading]=useState(false);const[submitted,setSubmitted]=useState(false);const{login}=useAuth();const handleSubmit=async e=>{e.preventDefault();if(submitted||loading)return;// Prevent multiple submissions\nsetError('');setMessage('');setLoading(true);setSubmitted(true);try{const response=await api.post('/auth/login',{collegeId,password,role});login(response.data.token,response.data.user);setMessage('Login successful');setLoading(false);// Redirect will be handled by the AuthContext\n}catch(error){var _error$response;const status=(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status;if(status===404||status===401){var _error$response2,_error$response2$data;setError(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||'Invalid credentials');setSubmitted(false);// Allow retry only for auth errors\n}else{var _error$response3,_error$response3$data;setError(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Failed to login');setSubmitted(false);// Allow retry for other errors\n}setLoading(false);}};return/*#__PURE__*/_jsx(Container,{className:\"d-flex align-items-center justify-content-center\",style:{minHeight:'80vh'},children:/*#__PURE__*/_jsx(\"div\",{className:\"w-100\",style:{maxWidth:'400px'},children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4\",children:\"Login\"}),error&&/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:error}),message&&/*#__PURE__*/_jsx(Alert,{variant:\"success\",children:message}),/*#__PURE__*/_jsxs(Form,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{id:\"collegeId\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"College ID\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",value:collegeId,onChange:e=>setCollegeId(e.target.value),required:true,placeholder:\"Enter your college ID\"})]}),/*#__PURE__*/_jsxs(Form.Group,{id:\"password\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,placeholder:\"Enter your password\"})]}),/*#__PURE__*/_jsxs(Form.Group,{id:\"role\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Login as\"}),/*#__PURE__*/_jsxs(Form.Select,{value:role,onChange:e=>setRole(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"maintainer\",children:\"Maintainer\"}),/*#__PURE__*/_jsx(\"option\",{value:\"field_head\",children:\"Field Head\"})]})]}),/*#__PURE__*/_jsx(Button,{disabled:loading,className:\"w-100\",type:\"submit\",children:\"Login\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-100 text-center mt-3\",children:/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Need an account? Register\"})})]})})})});};export default Login;","map":{"version":3,"names":["React","useState","Form","Button","Alert","Card","Container","Link","useAuth","api","jsx","_jsx","jsxs","_jsxs","Login","collegeId","setCollegeId","password","setPassword","role","setRole","error","setError","message","setMessage","loading","setLoading","submitted","setSubmitted","login","handleSubmit","e","preventDefault","response","post","data","token","user","_error$response","status","_error$response2","_error$response2$data","_error$response3","_error$response3$data","className","style","minHeight","children","maxWidth","Body","variant","onSubmit","Group","id","Label","Control","type","value","onChange","target","required","placeholder","Select","disabled","to"],"sources":["/Users/sunnykishan/maincp/campus-issue-reporter/frontend/src/components/auth/Login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { Form, Button, Alert, Card, Container } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\nimport api from '../../services/api';\n\nconst Login = () => {\n  const [collegeId, setCollegeId] = useState('');\n  const [password, setPassword] = useState('');\n  const [role, setRole] = useState('user');\n  const [error, setError] = useState('');\n  const [message, setMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [submitted, setSubmitted] = useState(false);\n  const { login } = useAuth();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (submitted || loading) return; // Prevent multiple submissions\n\n    setError('');\n    setMessage('');\n    setLoading(true);\n    setSubmitted(true);\n\n    try {\n      const response = await api.post('/auth/login', { collegeId, password, role });\n      login(response.data.token, response.data.user);\n      setMessage('Login successful');\n      setLoading(false);\n      // Redirect will be handled by the AuthContext\n    } catch (error) {\n      const status = error.response?.status;\n      if (status === 404 || status === 401) {\n        setError(error.response?.data?.error || 'Invalid credentials');\n        setSubmitted(false); // Allow retry only for auth errors\n      } else {\n        setError(error.response?.data?.error || 'Failed to login');\n        setSubmitted(false); // Allow retry for other errors\n      }\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Container className=\"d-flex align-items-center justify-content-center\" style={{ minHeight: '80vh' }}>\n      <div className=\"w-100\" style={{ maxWidth: '400px' }}>\n        <Card>\n          <Card.Body>\n            <h2 className=\"text-center mb-4\">Login</h2>\n            {error && <Alert variant=\"danger\">{error}</Alert>}\n            {message && <Alert variant=\"success\">{message}</Alert>}\n            \n              <Form onSubmit={handleSubmit}>\n                <Form.Group id=\"collegeId\" className=\"mb-3\">\n                  <Form.Label>College ID</Form.Label>\n                  <Form.Control\n                    type=\"text\"\n                    value={collegeId}\n                    onChange={(e) => setCollegeId(e.target.value)}\n                    required\n                    placeholder=\"Enter your college ID\"\n                  />\n                </Form.Group>\n                <Form.Group id=\"password\" className=\"mb-3\">\n                  <Form.Label>Password</Form.Label>\n                  <Form.Control\n                    type=\"password\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    required\n                    placeholder=\"Enter your password\"\n                  />\n                </Form.Group>\n                <Form.Group id=\"role\" className=\"mb-3\">\n                  <Form.Label>Login as</Form.Label>\n                  <Form.Select value={role} onChange={(e) => setRole(e.target.value)}>\n                    <option value=\"user\">User</option>\n                    <option value=\"maintainer\">Maintainer</option>\n                    <option value=\"field_head\">Field Head</option>\n                  </Form.Select>\n                </Form.Group>\n                <Button disabled={loading} className=\"w-100\" type=\"submit\">\n                  Login\n                </Button>\n              </Form>\n            \n            <div className=\"w-100 text-center mt-3\">\n              <Link to=\"/register\">Need an account? Register</Link>\n            </div>\n          </Card.Body>\n        </Card>\n      </div>\n    </Container>\n  );\n};\n\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}