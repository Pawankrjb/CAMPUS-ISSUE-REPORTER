{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Container,Row,Col,Card,ListGroup,Badge,Button,Alert,Spinner}from'react-bootstrap';import{Link}from'react-router-dom';import{useAuth}from'../../context/AuthContext';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AllReports=()=>{const[reports,setReports]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const{user}=useAuth();useEffect(()=>{const fetchReports=async()=>{try{// Fetch all reports for the field head's department\nconst response=await api.get(\"/reports/department/\".concat(user.department));setReports(response.data.reports);}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Failed to fetch reports');}finally{setLoading(false);}};if(user!==null&&user!==void 0&&user.department){fetchReports();}},[user===null||user===void 0?void 0:user.department]);// Only depend on department to prevent unnecessary re-runs\nconst getStatusBadge=status=>{switch(status){case'pending':return/*#__PURE__*/_jsx(Badge,{bg:\"info\",children:\"Pending\"});case'verified':return/*#__PURE__*/_jsx(Badge,{bg:\"primary\",children:\"Verified\"});case'assigned':return/*#__PURE__*/_jsx(Badge,{bg:\"warning\",children:\"Assigned\"});case'in_progress':return/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:\"In Progress\"});case'resolved':return/*#__PURE__*/_jsx(Badge,{bg:\"success\",children:\"Resolved\"});case'fake':return/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Fake\"});default:return/*#__PURE__*/_jsx(Badge,{bg:\"secondary\",children:status});}};const formatDate=dateString=>{return new Date(dateString).toLocaleString();};if(loading){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mt-5\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})})});}if(error){return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(Alert,{variant:\"danger\",className:\"mt-4\",children:error})});}return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Row,{className:\"mb-4\",children:/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"All Reports in \",user===null||user===void 0?void 0:user.department,\" Department\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-muted\",children:\"View all reports assigned to your department\"})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Card.Header,{as:\"h5\",children:\"Reports\"}),/*#__PURE__*/_jsx(Card.Body,{children:reports.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-4\",children:\"No reports found in your department\"}):/*#__PURE__*/_jsx(ListGroup,{children:reports.map(report=>/*#__PURE__*/_jsx(ListGroup.Item,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex justify-content-between align-items-start\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Card.Title,{children:report.title}),/*#__PURE__*/_jsxs(Card.Subtitle,{className:\"mb-2 text-muted\",children:[report.category,\" \\u2022 \",report.location]}),/*#__PURE__*/_jsxs(Card.Text,{children:[report.description.substring(0,100),report.description.length>100&&'...']}),/*#__PURE__*/_jsxs(Card.Text,{className:\"text-muted\",children:[\"Reported by \",report.reporterName,\" on \",formatDate(report.createdAt)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column align-items-end\",children:[getStatusBadge(report.status),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:/*#__PURE__*/_jsx(Button,{as:Link,to:\"/report/\".concat(report._id),variant:\"outline-primary\",size:\"sm\",children:\"View Details\"})})]})]})})})},report._id))})})]})})})]});};export default AllReports;","map":{"version":3,"names":["React","useState","useEffect","Container","Row","Col","Card","ListGroup","Badge","Button","Alert","Spinner","Link","useAuth","api","jsx","_jsx","jsxs","_jsxs","AllReports","reports","setReports","loading","setLoading","error","setError","user","fetchReports","response","get","concat","department","data","_error$response","_error$response$data","getStatusBadge","status","bg","children","formatDate","dateString","Date","toLocaleString","className","animation","role","variant","Header","as","Body","length","map","report","Item","Title","title","Subtitle","category","location","Text","description","substring","reporterName","createdAt","to","_id","size"],"sources":["/Users/sunnykishan/maincp/campus-issue-reporter/frontend/src/components/reports/AllReports.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Container, Row, Col, Card, ListGroup, Badge, Button, Alert, Spinner } from 'react-bootstrap';\nimport { Link } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\nimport api from '../../services/api';\n\nconst AllReports = () => {\n  const [reports, setReports] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const { user } = useAuth();\n\n  useEffect(() => {\n    const fetchReports = async () => {\n      try {\n        // Fetch all reports for the field head's department\n        const response = await api.get(`/reports/department/${user.department}`);\n        setReports(response.data.reports);\n      } catch (error) {\n        setError(error.response?.data?.error || 'Failed to fetch reports');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (user?.department) {\n      fetchReports();\n    }\n  }, [user?.department]); // Only depend on department to prevent unnecessary re-runs\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'pending':\n        return <Badge bg=\"info\">Pending</Badge>;\n      case 'verified':\n        return <Badge bg=\"primary\">Verified</Badge>;\n      case 'assigned':\n        return <Badge bg=\"warning\">Assigned</Badge>;\n      case 'in_progress':\n        return <Badge bg=\"secondary\">In Progress</Badge>;\n      case 'resolved':\n        return <Badge bg=\"success\">Resolved</Badge>;\n      case 'fake':\n        return <Badge bg=\"danger\">Fake</Badge>;\n      default:\n        return <Badge bg=\"secondary\">{status}</Badge>;\n    }\n  };\n\n  const formatDate = (dateString) => {\n    return new Date(dateString).toLocaleString();\n  };\n\n  if (loading) {\n    return (\n      <Container>\n        <div className=\"d-flex justify-content-center mt-5\">\n          <Spinner animation=\"border\" role=\"status\">\n            <span className=\"visually-hidden\">Loading...</span>\n          </Spinner>\n        </div>\n      </Container>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container>\n        <Alert variant=\"danger\" className=\"mt-4\">{error}</Alert>\n      </Container>\n    );\n  }\n\n  return (\n    <Container>\n      <Row className=\"mb-4\">\n        <Col>\n          <h1>All Reports in {user?.department} Department</h1>\n          <p className=\"text-muted\">View all reports assigned to your department</p>\n        </Col>\n      </Row>\n\n      <Row>\n        <Col>\n          <Card>\n            <Card.Header as=\"h5\">Reports</Card.Header>\n            <Card.Body>\n              {reports.length === 0 ? (\n                <div className=\"text-center mt-4\">No reports found in your department</div>\n              ) : (\n                <ListGroup>\n                  {reports.map(report => (\n                    <ListGroup.Item key={report._id} className=\"mb-3\">\n                      <Card>\n                        <Card.Body>\n                          <div className=\"d-flex justify-content-between align-items-start\">\n                            <div>\n                              <Card.Title>{report.title}</Card.Title>\n                              <Card.Subtitle className=\"mb-2 text-muted\">\n                                {report.category} â€¢ {report.location}\n                              </Card.Subtitle>\n                              <Card.Text>\n                                {report.description.substring(0, 100)}\n                                {report.description.length > 100 && '...'}\n                              </Card.Text>\n                              <Card.Text className=\"text-muted\">\n                                Reported by {report.reporterName} on {formatDate(report.createdAt)}\n                              </Card.Text>\n                            </div>\n                            <div className=\"d-flex flex-column align-items-end\">\n                              {getStatusBadge(report.status)}\n                              <div className=\"mt-2\">\n                                <Button\n                                  as={Link}\n                                  to={`/report/${report._id}`}\n                                  variant=\"outline-primary\"\n                                  size=\"sm\"\n                                >\n                                  View Details\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        </Card.Body>\n                      </Card>\n                    </ListGroup.Item>\n                  ))}\n                </ListGroup>\n              )}\n            </Card.Body>\n          </Card>\n        </Col>\n      </Row>\n    </Container>\n  );\n};\n\nexport default AllReports;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}